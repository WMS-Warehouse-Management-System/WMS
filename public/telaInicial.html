<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exibir Gráfico</title>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <link rel="stylesheet" href="css/telaInicial.css">
</head>
<body>
    <button id="logoutButton" style="display:none;" >Sair</button>
    <div class="container-grafico">
    <div id="chart" ></div> 
    <input type="checkbox" id="mudar" onclick="trocarGrafico()"> 
    <label for="mudar" id="Alternar"><span>Alternar Gráfico</span></label>
    
</div>
<div class="button-container">
   <div class="button green">
    <img src="imagens/Vector (1).svg" alt="">
    <div class="texto">
      <p>Cadastro</p>
      <small>Cadastrar Novo Item</small>
    </div>
    </div>
    <div class="button red">
        <img src="imagens/Vector.svg" alt="">
        <div class="texto">
      <p>Edição</p>
      <small>Editar/Excluir Itens</small>
    </div>
    </div>
    <div class="button blue" onclick="redirecionarEstoque()">
        <img src="imagens/vaadin_storage.svg" alt="">
        <div class="texto">
      <p>Estoque</p>
      <small>WMS</small>
    </div>
    </div>
    <div class="button yellow" onclick="redirecionarFinanceiro()">
        <img src="imagens/ic_outline-attach-money.svg" alt="">
        <div class="texto">
      <p>Financeiro</p>
      <small>Movimentações</small>
    </div>
    </div>
    
  </div>


    <!-- <li><a href="/adicionarUsuario.html">Adicionar Usuário</a></li>
    <li><a href="/deletarUsuario.html">Deletar Usuario</a></li>
    <li><a href="/verUsuarios.html">Ver Usuarios</a></li>
    <li><a href="/verUsuariosView.html">Ver Usuarios com view</a></li>
    <li><a href="/grafico.html">Grafico</a></li>
    <li><a href="/login.html">Login</a></li>
    <li><a href="/adicionarProduto.html">adicionar produto</a></li>
<<<<<<< HEAD
    <li><a href="/categoria.html"> categoria</a></li>
    <li><a href="financeiro.html">financeiro</a></li>
=======
    <li><a href="/categoria.html"> categoria</a></li> -->
</body>
<script>

            // ---------------------------------------------logout

            document.getElementById('logoutButton').addEventListener('click', async () => {
            const usuarioLogado = JSON.parse(localStorage.getItem('usuarioLogado'));

            if (!usuarioLogado) {
                alert('Nenhum usuário está logado!');
                return;
            }

            try {
                const response = await fetch('http://localhost:3000/logout', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: usuarioLogado.email }),
                });

                if (response.ok) {
                    alert('Logout realizado com sucesso!');
                    localStorage.removeItem('usuarioLogado');
                    document.getElementById('logoutButton').style.display = 'none';
                    window.location.href = "index.html"; 
                } else {
                    const errorMessage = await response.text();
                    alert('Erro ao fazer logout: ' + errorMessage);
                }
            } catch (error) {
                alert('Erro ao fazer logout: ' + error.message);
            }
        });

        // Atualiza o botão de logout após o login
        function toggleLogoutButton() {
            const usuarioLogado = JSON.parse(localStorage.getItem('usuarioLogado'));
            document.getElementById('logoutButton').style.display = usuarioLogado ? 'block' : 'none';
        }

        // Chamando a função para garantir consistência ao carregar a página
        toggleLogoutButton();


    // Redireciona para respectiva tela 
    function redirecionarFinanceiro() {
            window.location.href = "financeiro.html"; 
        }
    function redirecionarEstoque() {
            window.location.href = "catalogo.html"; 
        }


    var chart; // Variável para armazenar a instância do gráfico

    // Definir cores para o gráfico de barras
    var colors = ['#FF4560', '#008FFB', '#00E396', '#FEB019', '#775DD0', '#546E7A', '#26A69A', '#D10CE8'];

    // Opções do gráfico 1
    var options1 = {
        series: [{
            name: 'series1',
            data: [31, 40, 28, 51, 42, 109, 100]
        }, {
            name: 'series2',
            data: [11, 32, 45, 32, 34, 52, 41]
        }],
        chart: {
            height: 350,
            type: 'area'
        },
        dataLabels: {
            enabled: false
        },
        stroke: {
            curve: 'smooth'
        },
        xaxis: {
            type: 'datetime',
            categories: [
                "2018-09-19T00:00:00.000Z",
                "2018-09-19T01:30:00.000Z",
                "2018-09-19T02:30:00.000Z",
                "2018-09-19T03:30:00.000Z",
                "2018-09-19T04:30:00.000Z",
                "2018-09-19T05:30:00.000Z",
                "2018-09-19T06:30:00.000Z"
            ]
        },
        tooltip: {
            x: {
                format: 'dd/MM/yy HH:mm'
            }
        }
    };

    // Opções do gráfico 2
    var options = {
        series: [{
            data: [21, 22, 10, 28, 16, 21, 13,38]
        }],
        chart: {
            height: 350,
            type: 'bar'
        },
        colors: colors,
        plotOptions: {
            bar: {
                columnWidth: '45%',
                distributed: true,
            }
        },
        dataLabels: {
            enabled: false
        },
        legend: {
            show: false
        },
        xaxis: {
            categories: [
                ['John', 'Doe'],
                ['Joe', 'Smith'],
                ['Jake', 'Williams'],
                'Amber',
                ['Peter', 'Brown'],
                ['Mary', 'Evans'],
                ['David', 'Wilson'],
                ['Lily', 'Roberts'], 
            ],
            labels: {
                style: {
                    colors: colors,
                    fontSize: '12px'
                }
            }
        }
    };

    function trocarGrafico() {
        if (chart) chart.destroy();

        var checkbox = document.getElementById('mudar');
        if (checkbox.checked) {
            chart = new ApexCharts(document.querySelector("#chart"), options);
        } else {
            chart = new ApexCharts(document.querySelector("#chart"), options1);
        }
        chart.render(); 
    }


    trocarGrafico();
</script>
</html>
